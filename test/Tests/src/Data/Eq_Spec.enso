from Standard.Base import all
import Standard.Base.Data.Index_Sub_Range
from Standard.Base.Data.Eq import all

from Standard.Test import Test, Test_Suite

spec = Test.group "Test equality on numbers" <|
    Test.specify "Compare different numbers" <|
        x = 10
        y = 20.3
        t = x === y
        t . should_equal False

    Test.specify "Compare same numbers" <|
        x = 10
        y = 10
        t = x === y
        t . should_equal True

    Test.specify "Different hash prevents equality" <|
        x = Wrong_Hash.Elem1
        y = Wrong_Hash.Elem2

        t = x === y
        t . should_equal False


type Wrong_Hash
    Elem1
    Elem2

Wrong_Hash.equality self = Wrong_Hash_Eq

type Wrong_Hash_Eq
    hash_code e = case e of
        Wrong_Hash.Elem1 -> 1
        Wrong_Hash.Elem2 -> 2
    eq _ _ = True


main = Test_Suite.run_main spec
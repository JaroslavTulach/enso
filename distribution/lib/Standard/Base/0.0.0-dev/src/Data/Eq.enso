import project.Data.Ordering.Ordering
import project.Data.Pair.Pair
from Standard.Base import Number, Decimal
import project.Data.Text.Text
import project.Data.Any.Any
import project.Nothing.Nothing
import project.Meta
import project.IO

from project.Data.Boolean import Boolean, True, False
from project.Data.Json import all
from project.Data.Range import all
from project.Error.Common import Error, dataflow_error_handler

type Eq T
    hash_code : T -> Integer
    hash_code _ = Nothing
    eq : T -> T -> Boolean
    eq _ _ = Nothing

Any.equality : Any -> Eq | Nothing
Any.equality = Nothing

type Num_Eq
    hash_code n = n
    eq n1 n2 = n1 == n2

Number.equality = Num_Eq

Any.=== self that =
    eq_self = self.equality
    eq_that = that.equality

    similar_type = eq_self == eq_that
    if similar_type.not then False else
        hash_self = eq_self.hash_code self
        hash_that = eq_self.hash_code that
        if hash_self != hash_that then False else
            eq_self.eq self that
